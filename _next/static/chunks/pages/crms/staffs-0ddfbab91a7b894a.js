(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[154],{98250:function(e,r,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/crms/staffs",function(){return s(63128)}])},63128:function(e,r,s){"use strict";s.r(r);var l=s(85893),a=s(67294),n=s(80562),t=s(73812),i=s(31538),o=s(29630),d=s(21448),c=s(79072),m=s(49837),x=s(59742),u=s(61953),h=s(67836),f=s(75084),Z=s(91359),j=s(1890),p=s(77745),g=s(95398),N=s(55343),b=s(32631),C=s(98966),v=s(21609),y=s(74231),S=s(47533),w=s(87536),W=s(94314),_=s(5464),P=s(86501);let q=e=>{let{id:r,status:s,permitStaff:o,editStaff:d,deleteStaff:c}=e,[m,x]=(0,a.useState)(null),u=Boolean(m),h=e=>{x(e.currentTarget)},f=()=>{x(null)},Z=()=>{o(r,s),f()},j=()=>{d(r),f()},p=()=>{c(r),f()};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.Z,{size:"small",onClick:h,children:(0,l.jsx)(v.Z,{icon:"mdi:dots-vertical"})}),(0,l.jsxs)(t.Z,{keepMounted:!0,anchorEl:m,open:u,onClose:f,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{style:{minWidth:"8rem"}},children:[s?(0,l.jsxs)(i.Z,{onClick:Z,sx:{"& svg":{mr:2}},children:[(0,l.jsx)(v.Z,{icon:"mdi:account-lock",fontSize:20}),"Pause"]}):(0,l.jsxs)(i.Z,{onClick:Z,sx:{"& svg":{mr:2}},children:[(0,l.jsx)(v.Z,{icon:"mdi:account-lock-open",fontSize:20}),"Allow"]}),(0,l.jsxs)(i.Z,{onClick:j,sx:{"& svg":{mr:2}},children:[(0,l.jsx)(v.Z,{icon:"mdi:pencil-outline",fontSize:20}),"Edit"]}),(0,l.jsxs)(i.Z,{onClick:p,sx:{"& svg":{mr:2}},children:[(0,l.jsx)(v.Z,{icon:"mdi:delete-outline",fontSize:20}),"Delete"]})]})]})},k=()=>{let[e,r]=(0,a.useState)(!0),[s,t]=(0,a.useState)(""),[i,W]=(0,a.useState)(10),[k,z]=(0,a.useState)([]),[E,I]=(0,a.useState)(!1),[Q,B]=(0,a.useState)(!1),[T,R]=(0,a.useState)(0),A={firstName:"",lastName:"",email:"",phone:"",password:""},F=y.Ry().shape({firstName:y.Z_().required(),lastName:y.Z_().required(),email:y.Z_().email().required(),phone:y.Z_().min(10,"Phone number must be 10 digits").required(),password:y.Z_().required()}),L=y.Ry().shape({firstName:y.Z_().required(),lastName:y.Z_().required(),email:y.Z_().email().required(),phone:y.Z_().min(10,"Phone number must be 10 digits").required()});(0,a.useEffect)(()=>{let e=async()=>{let{data:e}=await _.Z.get("crms/staffs",{params:{search:""}});z(e)};e()},[e,s,i]);let{reset:M,control:O,handleSubmit:X,formState:{errors:H}}=(0,w.cI)({defaultValues:A,mode:"onChange",resolver:(0,S.X)(F)}),{reset:D,control:G,handleSubmit:U,formState:{errors:J}}=(0,w.cI)({defaultValues:A,mode:"onChange",resolver:(0,S.X)(L)}),K=()=>{I(!0)},V=async s=>{let{data:l}=await _.Z.post("crms/staffs",{...s,role:"staff"});l.status?(M(A),I(!1),r(!e),P.ZP.success(l.msg)):P.ZP.error(l.msg)},Y=async e=>{R(e);let{data:r}=await _.Z.get("crms/staffs/".concat(e));D({firstName:r.firstName,lastName:r.lastName,email:r.email,phone:r.phone}),B(!0)},$=async(s,l)=>{let{data:a}=await _.Z.put("/crms/staffs/".concat(s),{status:!l});a.status?(P.ZP.success(a.msg),r(!e)):P.ZP.error(a.msg)},ee=async s=>{let{data:l}=await _.Z.put("crms/staffs/".concat(T),s);l.status?(D(A),B(!1),r(!e),P.ZP.success(l.msg)):P.ZP.error(l.msg)},er=async s=>{let{data:l}=await _.Z.delete("crms/staffs/".concat(s));l.status?(r(!e),P.ZP.success(l.msg)):P.ZP.error(l.msg)};return(0,l.jsxs)(c.ZP,{container:!0,spacing:6,children:[(0,l.jsx)(c.ZP,{item:!0,xs:12,children:(0,l.jsxs)(m.Z,{children:[(0,l.jsx)(x.Z,{title:(0,l.jsxs)(u.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,l.jsx)(o.Z,{variant:"h5",children:"Staff Management"}),(0,l.jsx)(u.Z,{sx:{pl:0,pr:0,pt:0,pb:0,display:"flex",flex:1,flexWrap:"wrap",alignItems:"center",justifyContent:"flex-end"},children:(0,l.jsxs)(u.Z,{sx:{display:"flex",flexWrap:"wrap",alignItems:"center"},children:[(0,l.jsx)(h.Z,{size:"small",value:s,sx:{mr:6,mb:2},placeholder:"Search staff...",onChange:e=>t(e.target.value)}),(0,l.jsxs)(f.Z,{sx:{mb:2},onClick:K,variant:"contained",children:[(0,l.jsx)(v.Z,{icon:"mdi:plus"})," Add staff"]})]})})]})}),(0,l.jsx)(Z.Z,{children:(0,l.jsx)(C._,{autoHeight:!0,getRowId:e=>e._id,rows:k,columns:[{flex:.2,minWidth:230,field:"firstName",headerName:"First Name",renderCell(e){let{row:r}=e;return(0,l.jsx)(o.Z,{noWrap:!0,children:r.firstName})}},{flex:.2,minWidth:250,field:"lastName",headerName:"Last Name",renderCell(e){let{row:r}=e;return(0,l.jsx)(o.Z,{noWrap:!0,children:r.lastName})}},{flex:.3,minWidth:250,field:"email",headerName:"Email",renderCell(e){let{row:r}=e;return(0,l.jsx)(o.Z,{noWrap:!0,children:r.email})}},{flex:.1,minWidth:250,field:"phone",headerName:"Phone",renderCell(e){let{row:r}=e;return(0,l.jsx)(o.Z,{noWrap:!0,children:r.phone})}},{flex:.1,minWidth:100,field:"status",headerName:"Status",renderCell(e){let{row:r}=e;return(0,l.jsx)(d.Z,{skin:"light",size:"small",variant:"filled",label:r.status?"Approved":"Refused",color:r.status?"success":"warning",sx:{textTransform:"capitalize","& .MuiChip-label":{lineHeight:"18px"}}})}},{flex:.1,sortable:!1,field:"actions",headerName:"Actions",renderCell(e){let{row:r}=e;return(0,l.jsx)(q,{id:r._id,status:r.status,permitStaff:$,editStaff:Y,deleteStaff:er})}}],pageSize:i,sx:{"& .MuiDataGrid-columnHeaders":{borderRadius:0}},onPageSizeChange:e=>W(e)})})]})}),(0,l.jsxs)(j.Z,{fullWidth:!0,maxWidth:"sm",onClose:()=>I(!1),open:E,children:[(0,l.jsxs)(p.Z,{children:["New Staff",(0,l.jsx)(n.Z,{onClick:()=>I(!1),sx:{position:"absolute",right:18,top:18,color:"#aaaaaa"},children:(0,l.jsx)(v.Z,{icon:"mdi:close"})})]}),(0,l.jsx)(g.Z,{sx:{p:6},children:(0,l.jsxs)("form",{onSubmit:X(V),style:{paddingTop:8},children:[(0,l.jsxs)(N.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(w.Qr,{name:"firstName",control:O,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{value:r,label:"First Name",onChange:s,error:Boolean(H.firstName)})}}),H.firstName&&(0,l.jsx)(b.Z,{sx:{color:"error.main"},children:H.firstName.message})]}),(0,l.jsxs)(N.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(w.Qr,{name:"lastName",control:O,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{value:r,label:"Last Name",onChange:s,error:Boolean(H.lastName)})}}),H.lastName&&(0,l.jsx)(b.Z,{sx:{color:"error.main"},children:H.lastName.message})]}),(0,l.jsxs)(N.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(w.Qr,{name:"email",control:O,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{type:"email",value:r,label:"Email",onChange:s,error:Boolean(H.email)})}}),H.email&&(0,l.jsx)(b.Z,{sx:{color:"error.main"},children:H.email.message})]}),(0,l.jsxs)(N.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(w.Qr,{name:"phone",control:O,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{type:"string",label:"Phone",value:r,onChange:s})}}),H.phone&&(0,l.jsx)(b.Z,{sx:{color:"error.main"},children:H.phone.message})]}),(0,l.jsxs)(N.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(w.Qr,{name:"password",control:O,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{type:"text",label:"Password",value:r,onChange:s,error:Boolean(H.password)})}}),H.password&&(0,l.jsx)(b.Z,{sx:{color:"error.main"},children:H.password.message})]}),(0,l.jsxs)(u.Z,{sx:{display:"flex",justifyContent:"flex-end"},children:[(0,l.jsx)(f.Z,{type:"submit",variant:"contained",color:"primary",size:"large",startIcon:(0,l.jsx)(v.Z,{icon:"mdi:content-save"}),sx:{mr:4},children:"Save"}),(0,l.jsx)(f.Z,{variant:"contained",color:"error",size:"large",startIcon:(0,l.jsx)(v.Z,{icon:"mdi:delete"}),onClick:()=>I(!1),children:"Cancel"})]})]})})]}),(0,l.jsxs)(j.Z,{fullWidth:!0,maxWidth:"sm",onClose:()=>B(!1),open:Q,children:[(0,l.jsxs)(p.Z,{children:["Edit Staff",(0,l.jsx)(n.Z,{onClick:()=>B(!1),sx:{position:"absolute",right:18,top:18,color:"#aaaaaa"},children:(0,l.jsx)(v.Z,{icon:"mdi:close"})})]}),(0,l.jsx)(g.Z,{sx:{p:6},children:(0,l.jsxs)("form",{onSubmit:U(ee),style:{paddingTop:8},children:[(0,l.jsxs)(N.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(w.Qr,{name:"firstName",control:G,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{value:r,label:"First Name",onChange:s,error:Boolean(J.firstName)})}}),J.firstName&&(0,l.jsx)(b.Z,{sx:{color:"error.main"},children:J.firstName.message})]}),(0,l.jsxs)(N.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(w.Qr,{name:"lastName",control:G,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{value:r,label:"Last Name",onChange:s,error:Boolean(J.lastName)})}}),J.lastName&&(0,l.jsx)(b.Z,{sx:{color:"error.main"},children:J.lastName.message})]}),(0,l.jsxs)(N.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(w.Qr,{name:"email",control:G,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{type:"email",value:r,label:"Email",onChange:s,error:Boolean(J.email)})}}),J.email&&(0,l.jsx)(b.Z,{sx:{color:"error.main"},children:J.email.message})]}),(0,l.jsxs)(N.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(w.Qr,{name:"phone",control:G,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{type:"string",label:"Phone",value:r,onChange:s,error:Boolean(J.phone)})}}),J.phone&&(0,l.jsx)(b.Z,{sx:{color:"error.main"},children:J.phone.message})]}),(0,l.jsx)(N.Z,{fullWidth:!0,sx:{mb:6},children:(0,l.jsx)(w.Qr,{name:"password",control:G,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{type:"text",label:"Password",value:r,onChange:s})}})}),(0,l.jsxs)(u.Z,{sx:{display:"flex",justifyContent:"flex-end"},children:[(0,l.jsx)(f.Z,{type:"submit",variant:"contained",color:"primary",size:"large",startIcon:(0,l.jsx)(v.Z,{icon:"mdi:content-save"}),sx:{mr:4},children:"Update"}),(0,l.jsx)(f.Z,{variant:"contained",color:"error",size:"large",startIcon:(0,l.jsx)(v.Z,{icon:"mdi:delete"}),onClick:()=>B(!1),children:"Cancel"})]})]})})]})]})};k.getLayout=e=>(0,l.jsx)(W.Z,{children:e}),r.default=k}},function(e){e.O(0,[828,480,428,515,259,330,323,72,733,795,476,314,774,888,179],function(){return e(e.s=98250)}),_N_E=e.O()}]);