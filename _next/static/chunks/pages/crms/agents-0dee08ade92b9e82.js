(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[158],{47386:function(e,r,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/crms/agents",function(){return s(82534)}])},82534:function(e,r,s){"use strict";s.r(r);var l=s(85893),a=s(67294),n=s(80562),i=s(73812),t=s(31538),d=s(29630),o=s(21448),m=s(79072),c=s(49837),x=s(59742),u=s(61953),h=s(67836),Z=s(75084),j=s(91359),p=s(1890),f=s(77745),g=s(95398),b=s(55343),N=s(32631),C=s(98966),q=s(21609),v=s(74231),P=s(47533),W=s(87536),y=s(94314),w=s(5464),_=s(86501);let S=e=>{let{id:r,status:s,permitAgent:d,editAgent:o,deleteAgent:m}=e,[c,x]=(0,a.useState)(null),u=Boolean(c),h=e=>{x(e.currentTarget)},Z=()=>{x(null)},j=()=>{d(r,s),Z()},p=()=>{o(r),Z()},f=()=>{m(r),Z()};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.Z,{size:"small",onClick:h,children:(0,l.jsx)(q.Z,{icon:"mdi:dots-vertical"})}),(0,l.jsxs)(i.Z,{keepMounted:!0,anchorEl:c,open:u,onClose:Z,anchorOrigin:{vertical:"bottom",horizontal:"right"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{style:{minWidth:"8rem"}},children:[s?(0,l.jsxs)(t.Z,{onClick:j,sx:{"& svg":{mr:2}},children:[(0,l.jsx)(q.Z,{icon:"mdi:account-lock",fontSize:20}),"Pause"]}):(0,l.jsxs)(t.Z,{onClick:j,sx:{"& svg":{mr:2}},children:[(0,l.jsx)(q.Z,{icon:"mdi:account-lock-open",fontSize:20}),"Allow"]}),(0,l.jsxs)(t.Z,{onClick:p,sx:{"& svg":{mr:2}},children:[(0,l.jsx)(q.Z,{icon:"mdi:pencil-outline",fontSize:20}),"Edit"]}),(0,l.jsxs)(t.Z,{onClick:f,sx:{"& svg":{mr:2}},children:[(0,l.jsx)(q.Z,{icon:"mdi:delete-outline",fontSize:20}),"Delete"]})]})]})},k=()=>{let[e,r]=(0,a.useState)(!0),[s,i]=(0,a.useState)(""),[t,y]=(0,a.useState)(10),[k,A]=(0,a.useState)([]),[E,z]=(0,a.useState)(!1),[B,Q]=(0,a.useState)(!1),[I,R]=(0,a.useState)(0),T={firstName:"",lastName:"",corpName:"",email:"",phone:"",address:"",balance:100,password:""},F=v.Ry().shape({firstName:v.Z_().required("First name is required field."),lastName:v.Z_().required("Last name is required field."),corpName:v.Z_().required("Company name is required field."),email:v.Z_().email("Email is invalid.").required("Email is required field."),address:v.Z_().required("Address is required field."),phone:v.Z_().min(10,"Phone number must be at least 10 digits").required("Phone number is required field."),balance:v.Rx("Credit must be numeric").required("Credit is required field."),password:v.Z_().required("Password is required field.")}),L=v.Ry().shape({firstName:v.Z_().required("First name is required field."),lastName:v.Z_().required("Last name is required field."),corpName:v.Z_().required("Company name is required field."),email:v.Z_().email("Email is invalid.").required("Email is required field."),address:v.Z_().required(10,"Address is required field."),phone:v.Z_().min(10,"Phone number must be at least 10 digits").required("Phone number is required"),balance:v.Rx("Credit must be numeric").required("Credit is required field.")});(0,a.useEffect)(()=>{let e=async()=>{let{data:e}=await w.Z.get("crms/agents",{params:{search:""}});A(e)};e()},[e,s,t]);let{reset:M,control:O,handleSubmit:X,formState:{errors:H}}=(0,W.cI)({defaultValues:T,mode:"onChange",resolver:(0,P.X)(F)}),{reset:D,control:G,handleSubmit:U,formState:{errors:J}}=(0,W.cI)({defaultValues:T,mode:"onChange",resolver:(0,P.X)(L)}),K=()=>{z(!0)},V=async s=>{let{data:l}=await w.Z.post("crms/agents",{...s,role:"agent"});l.status?(M(T),z(!1),r(!e),_.ZP.success(l.msg)):_.ZP.error(l.msg)},Y=async e=>{R(e);let{data:r}=await w.Z.get("crms/agents/".concat(e));D({firstName:r.firstName,lastName:r.lastName,corpName:r.corpName,email:r.email,phone:r.phone,balance:r.balance,address:r.address,password:""}),Q(!0)},$=async(s,l)=>{let{data:a}=await w.Z.put("/crms/agents/".concat(s),{status:!l});a.status?(_.ZP.success(a.msg),r(!e)):_.ZP.error(a.msg)},ee=async s=>{let{data:l}=await w.Z.put("crms/agents/".concat(I),s);l.status?(D(T),Q(!1),r(!e),_.ZP.success(l.msg)):_.ZP.error(l.msg)},er=async s=>{let{data:l}=await w.Z.delete("crms/agents/".concat(s));l.status?r(!e):_.ZP.error(l.msg)};return(0,l.jsxs)(m.ZP,{container:!0,spacing:6,children:[(0,l.jsx)(m.ZP,{item:!0,xs:12,children:(0,l.jsxs)(c.Z,{children:[(0,l.jsx)(x.Z,{title:(0,l.jsxs)(u.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,l.jsx)(d.Z,{variant:"h5",children:"Agent Management"}),(0,l.jsx)(u.Z,{sx:{pl:0,pr:0,pt:0,pb:0,display:"flex",flex:1,flexWrap:"wrap",alignItems:"center",justifyContent:"flex-end"},children:(0,l.jsxs)(u.Z,{sx:{display:"flex",flexWrap:"wrap",alignItems:"center"},children:[(0,l.jsx)(h.Z,{size:"small",value:s,sx:{mr:6,mb:2},placeholder:"Search agent...",onChange:e=>i(e.target.value)}),(0,l.jsxs)(Z.Z,{sx:{mb:2},onClick:K,variant:"contained",children:[(0,l.jsx)(q.Z,{icon:"mdi:plus"})," Add agent"]})]})})]})}),(0,l.jsx)(j.Z,{children:(0,l.jsx)(C._,{autoHeight:!0,getRowId:e=>e._id,rows:k,columns:[{flex:.1,minWidth:140,field:"firstName",headerName:"First Name",renderCell(e){let{row:r}=e;return(0,l.jsx)(d.Z,{noWrap:!0,children:r.firstName})}},{flex:.1,minWidth:140,field:"lastName",headerName:"Last Name",renderCell(e){let{row:r}=e;return(0,l.jsx)(d.Z,{noWrap:!0,children:r.lastName})}},{flex:.1,minWidth:150,field:"corpName",headerName:"Company Name",renderCell(e){let{row:r}=e;return(0,l.jsx)(d.Z,{noWrap:!0,children:r.corpName})}},{flex:.3,minWidth:150,field:"email",headerName:"Email",renderCell(e){let{row:r}=e;return(0,l.jsx)(d.Z,{noWrap:!0,children:r.email})}},{flex:.1,minWidth:200,field:"phone",headerName:"Phone",renderCell(e){let{row:r}=e;return(0,l.jsx)(d.Z,{noWrap:!0,children:r.phone})}},{flex:.2,minWidth:300,field:"address",headerName:"Address",renderCell(e){let{row:r}=e;return(0,l.jsx)(d.Z,{noWrap:!0,children:r.address})}},{flex:.1,minWidth:100,field:"balance",headerName:"Credit",renderCell(e){let{row:r}=e;return(0,l.jsx)(d.Z,{noWrap:!0,children:r.balance})}},{flex:.1,minWidth:110,field:"status",headerName:"Status",renderCell(e){let{row:r}=e;return(0,l.jsx)(o.Z,{skin:"light",size:"small",variant:"filled",label:r.status?"Approved":"Refused",color:r.status?"success":"warning",sx:{textTransform:"capitalize","& .MuiChip-label":{lineHeight:"18px"}}})}},{flex:.1,sortable:!1,field:"actions",headerName:"Actions",renderCell(e){let{row:r}=e;return(0,l.jsx)(S,{id:r._id,status:r.status,permitAgent:$,editAgent:Y,deleteAgent:er})}}],rowsPerPageOptions:[10,25,50],pageSize:t,sx:{"& .MuiDataGrid-columnHeaders":{borderRadius:0}},onPageSizeChange:e=>y(e)})})]})}),(0,l.jsxs)(p.Z,{fullWidth:!0,maxWidth:"sm",onClose:()=>z(!1),open:E,children:[(0,l.jsxs)(f.Z,{children:["New Agent",(0,l.jsx)(n.Z,{onClick:()=>z(!1),sx:{position:"absolute",right:18,top:18,color:"#aaaaaa"},children:(0,l.jsx)(q.Z,{icon:"mdi:close"})})]}),(0,l.jsx)(g.Z,{sx:{p:6},children:(0,l.jsxs)("form",{onSubmit:X(V),style:{paddingTop:8},children:[(0,l.jsxs)(b.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(W.Qr,{name:"firstName",control:O,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{value:r,label:"First Name",onChange:s,error:Boolean(H.firstName)})}}),H.firstName&&(0,l.jsx)(N.Z,{sx:{color:"error.main"},children:H.firstName.message})]}),(0,l.jsxs)(b.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(W.Qr,{name:"lastName",control:O,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{value:r,label:"Last Name",onChange:s,error:Boolean(H.lastName)})}}),H.lastName&&(0,l.jsx)(N.Z,{sx:{color:"error.main"},children:H.lastName.message})]}),(0,l.jsxs)(m.ZP,{container:!0,spacing:6,children:[(0,l.jsx)(m.ZP,{item:!0,md:6,sm:12,children:(0,l.jsxs)(b.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(W.Qr,{name:"email",control:O,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{type:"email",value:r,label:"Email",onChange:s,error:Boolean(H.email)})}}),H.email&&(0,l.jsx)(N.Z,{sx:{color:"error.main"},children:H.email.message})]})}),(0,l.jsx)(m.ZP,{item:!0,md:6,sm:12,children:(0,l.jsxs)(b.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(W.Qr,{name:"phone",control:O,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{type:"string",label:"Phone",value:r,onChange:s,error:Boolean(H.phone)})}}),H.phone&&(0,l.jsx)(N.Z,{sx:{color:"error.main"},children:H.phone.message})]})})]}),(0,l.jsxs)(m.ZP,{container:!0,spacing:6,children:[(0,l.jsx)(m.ZP,{item:!0,md:6,sm:12,children:(0,l.jsxs)(b.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(W.Qr,{name:"corpName",control:O,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{value:r,label:"Corp Name",onChange:s,error:Boolean(H.corpName)})}}),H.corpName&&(0,l.jsx)(N.Z,{sx:{color:"error.main"},children:H.corpName.message})]})}),(0,l.jsx)(m.ZP,{item:!0,md:6,sm:12,children:(0,l.jsxs)(b.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(W.Qr,{name:"balance",control:O,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{type:"number",value:r,label:"Credit",onChange:s,error:Boolean(H.balance)})}}),H.balance&&(0,l.jsx)(N.Z,{sx:{color:"error.main"},children:H.balance.message})]})})]}),(0,l.jsxs)(b.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(W.Qr,{name:"address",control:O,render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{value:r,label:"Address",onChange:s,error:Boolean(H.address)})}}),H.address&&(0,l.jsx)(N.Z,{sx:{color:"error.main"},children:H.address.message})]}),(0,l.jsxs)(b.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(W.Qr,{name:"password",control:O,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{type:"text",label:"Password",value:r,onChange:s,error:Boolean(H.password)})}}),H.password&&(0,l.jsx)(N.Z,{sx:{color:"error.main"},children:H.password.message})]}),(0,l.jsxs)(u.Z,{sx:{display:"flex",justifyContent:"flex-end"},children:[(0,l.jsx)(Z.Z,{type:"submit",variant:"contained",color:"primary",size:"large",startIcon:(0,l.jsx)(q.Z,{icon:"mdi:content-save"}),sx:{mr:4},children:"Save"}),(0,l.jsx)(Z.Z,{variant:"contained",color:"error",size:"large",startIcon:(0,l.jsx)(q.Z,{icon:"mdi:delete"}),onClick:()=>z(!1),children:"Cancel"})]})]})})]}),(0,l.jsxs)(p.Z,{fullWidth:!0,maxWidth:"sm",onClose:()=>Q(!1),open:B,children:[(0,l.jsxs)(f.Z,{children:["Edit Agent",(0,l.jsx)(n.Z,{onClick:()=>Q(!1),sx:{position:"absolute",right:18,top:18,color:"#aaaaaa"},children:(0,l.jsx)(q.Z,{icon:"mdi:close"})})]}),(0,l.jsx)(g.Z,{sx:{p:6},children:(0,l.jsxs)("form",{onSubmit:U(ee),style:{paddingTop:8},children:[(0,l.jsxs)(b.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(W.Qr,{name:"firstName",control:G,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{value:r,label:"First Name",onChange:s,error:Boolean(J.firstName)})}}),J.firstName&&(0,l.jsx)(N.Z,{sx:{color:"error.main"},children:J.firstName.message})]}),(0,l.jsxs)(b.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(W.Qr,{name:"lastName",control:G,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{value:r,label:"Last Name",onChange:s,error:Boolean(J.lastName)})}}),J.lastName&&(0,l.jsx)(N.Z,{sx:{color:"error.main"},children:J.lastName.message})]}),(0,l.jsxs)(m.ZP,{container:!0,spacing:6,children:[(0,l.jsx)(m.ZP,{item:!0,md:6,sm:12,children:(0,l.jsxs)(b.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(W.Qr,{name:"email",control:G,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{type:"email",value:r,label:"Email",onChange:s,error:Boolean(J.email)})}}),J.email&&(0,l.jsx)(N.Z,{sx:{color:"error.main"},children:J.email.message})]})}),(0,l.jsx)(m.ZP,{item:!0,md:6,sm:12,children:(0,l.jsxs)(b.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(W.Qr,{name:"phone",control:G,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{type:"string",label:"Phone",value:r,onChange:s,error:Boolean(J.phone)})}}),J.phone&&(0,l.jsx)(N.Z,{sx:{color:"error.main"},children:J.phone.message})]})})]}),(0,l.jsxs)(m.ZP,{container:!0,spacing:6,children:[(0,l.jsx)(m.ZP,{item:!0,md:6,sm:12,children:(0,l.jsxs)(b.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(W.Qr,{name:"corpName",control:G,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{value:r,label:"Corp Name",onChange:s,placeholder:"ANZ MIGRATE",error:Boolean(J.corpName)})}}),J.corpName&&(0,l.jsx)(N.Z,{sx:{color:"error.main"},children:J.corpName.message})]})}),(0,l.jsx)(m.ZP,{item:!0,md:6,sm:12,children:(0,l.jsxs)(b.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(W.Qr,{name:"balance",control:G,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{type:"number",value:r,label:"Credit",onChange:s,placeholder:"100",error:Boolean(J.balance)})}}),J.balance&&(0,l.jsx)(N.Z,{sx:{color:"error.main"},children:J.balance.message})]})})]}),(0,l.jsxs)(b.Z,{fullWidth:!0,sx:{mb:6},children:[(0,l.jsx)(W.Qr,{name:"address",control:G,render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{value:r,label:"Address",onChange:s,error:Boolean(J.address)})}}),J.address&&(0,l.jsx)(N.Z,{sx:{color:"error.main"},children:J.address.message})]}),(0,l.jsx)(b.Z,{fullWidth:!0,sx:{mb:6},children:(0,l.jsx)(W.Qr,{name:"password",control:G,rules:{required:!0},render(e){let{field:{value:r,onChange:s}}=e;return(0,l.jsx)(h.Z,{type:"text",label:"Password",value:r,onChange:s})}})}),(0,l.jsxs)(u.Z,{sx:{display:"flex",justifyContent:"flex-end"},children:[(0,l.jsx)(Z.Z,{type:"submit",variant:"contained",color:"primary",size:"large",startIcon:(0,l.jsx)(q.Z,{icon:"mdi:content-save"}),sx:{mr:4},children:"Update"}),(0,l.jsx)(Z.Z,{variant:"contained",color:"error",size:"large",startIcon:(0,l.jsx)(q.Z,{icon:"mdi:delete"}),onClick:()=>Q(!1),children:"Cancel"})]})]})})]})]})};k.getLayout=e=>(0,l.jsx)(y.Z,{children:e}),r.default=k}},function(e){e.O(0,[828,480,428,515,259,330,323,72,733,795,476,314,774,888,179],function(){return e(e.s=47386)}),_N_E=e.O()}]);